---
title: "Nuxt.js 3がパブリックベータ版になったので新機能の紹介や所感など"
emoji: "🌲"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

# はじめに

2021/10/12 [Nuxt.js 3](https://nuxtjs.org/announcements/nuxt3-beta/) がパブリックベータ版に移行しました 🎉！
これによって誰でも触れるようになったというわけで、今回早速試してみました的な記事です。
（そしてなぜか Zenn ではあまり話題になってない…）

# Nuxt.js 3 の主な新機能

主な新機能は以下の通りです。

## Nitro Engine による高速化/軽量化および Nuxt.js 内部での API 作成への対応

[トップページ](https://v3.nuxtjs.org/)の記載によれば、75 倍の軽量化が実現したそうです。
高速化に関しては数値まで公表されていないですが、実際にアプリを作成したところバージョン２とは別物レベルで早くなっていました！
（Nitro server は h3 と rollup という２つのライブラリが内部で使用されているとのこと）

さらに Nitro Engine の恩恵で「Nuxt.js 内部での API 作成」にも対応しました 🎉！
フレームワーク内部での API 作成に関しては、Next.js とか Svelte Kit にはありましたが、ついに Nuxt.js にも。
この API 機能、新しく登場した `useAsyncData` メソッドとの組み合わせで真価を発揮するのですが、詳しくは後述します。

## Vue.js 3（Composition API 含む）のネイティブサポート

バージョン２の時点で一応対応されていましたが、Nuxt.js 3 では Vue.js 2 のサポートを切り捨てた上で対応しています。
それじゃあ Nuxt.js 2 から移行したいけどどうするの…と思った人もいるかと。
これに関しては後述の Nuxt Bridge で対応できる仕組みになっています。

## TypeScript のネイティブサポート

個人的にはこれが一番嬉しかったです！
他のライブラリだとオプションで TypeScript 設定をするパターンが殆どですが、Nuxt 3 に関してはそのままデフォルトアプリを作成するだけでそのまま使えるため、本当に驚きました。

ちなみに公式ドキュメントも全般的に TypeScript ベースでの内容になっておりかなり有り難いです。

## Nuxt 2 からの移行用として Nuxt Bridge が新登場

Nuxt Bridge は「Nuxt.js 2 からの移行どうすればいい問題」を一気に解決してくれます。
Nuxt Bridge への移行方法は[こちら](https://v3.nuxtjs.org/getting-started/bridge)に記載されています。
Vue 2 のまま Nuxt 3 の機能を体感できます。

なお（2021/10/19 時点）で Nuxt 2/Nuxt Bridge/Nuxt 3 の比較表はこんな形になっています。

![](/images/nuxt-comparison.png)

ちなみに Nuxt Bridge を使わずに Nuxt 3 への移行する方法も[ここ](https://v3.nuxtjs.org/getting-started/migration)で記載されています。
ただし記載されているように修正箇所がかなり多いため、スムーズに移行したい場合は Nuxt Bridge への移行が推奨されています。

## その他

その他以下の新機能/今後対応予定の機能もあります。

- Webpack 5 に対応
- Nuxt 2 までの Create Nuxt App に代わって Nuxt CLI が登場
- Suspense 機能の追加
- Nuxt Devtools(2021/10/18 時点ではまだ未対応)の登場

# Nuxt.js 3 のインストール〜アプリ立ち上げ

## 必要環境

公式ドキュメントは[こちら](https://v3.nuxtjs.org/getting-started/introduction)

以下の環境が公式で推奨されています。Vue 3 とほぼ同じです。

- (必須) Node.js version14 or version16 がインストール済み
- (推奨) VSCode の使用
- (推奨) [Volar](https://marketplace.visualstudio.com/items?itemName=johnsoncodehk.volar)の使用
  - ※[Vetur](https://marketplace.visualstudio.com/items?itemName=octref.vetur&WT.mc_id=marketplace-pack-sdras) がオンになっている場合は Vetur 側を disable にしておいてください

## Nuxt 3 アプリの新規作成〜ローカル立ち上げ

公式ドキュメントは[こちら](https://v3.nuxtjs.org/getting-started/installation)

前述した通り Nuxt 3 では Create Nuxt App に代わって Nuxt CLI を使用する形に変更されています。
そのため作成時のコマンドも、`npx create-nuxt-app ...` から `npx nuxi ...` になっています。

生成されるまでのコマンドは以下のとおりです。

```bash
npx nuxi init nuxt3-app

# VSCodeを使用している場合はこのコマンドでフォルダをVSCodeを開けます
code -r nuxt3-app

yarn install # or npm install

yarn dev -o # or npm run dev -- -o
```

最終的に `http://localhost:3000` で Nuxt 3 アプリが立ち上がります。

# Nuxt 3 のディレクトリ階層

[公式ドキュメント](https://v3.nuxtjs.org/docs/directory-structure/)では以下のディレクトリ階層が紹介されています。

```
|
|── .nuxt
|── .output
|── assets
|── components
|── layouts
|── pages
|── plugins
|── public
|── server
|── .gitignore
|── app.vue
├── nuxt.config.ts
├── package.json
├── tsconfig.json
```

現時点(2021/10/19 時点)のドキュメントの記載によれば、Nuxt 2 から代わった点に関しては以下 2 点が明記されています。

- `static` フォルダが `public` フォルダに変更
- 内部 API 実装用として `server` ディレクトリが新しく追加
- `composables` フォルダが新しく追加（※現在は未対応、[ここの issue](https://github.com/nuxt/framework/issues/639) を見る限りもうすぐ対応されそう？）
  - Vue 3 で新登場した Composition API 用のコンポジション関数(Composition Function)を格納するフォルダ

※その他 Nuxt 2 から modules/middleware/store ディレクトリも消えているようにも見受けられるのですが、これに関してはドキュメントに記載がないだけか本当に使用不可になったのかまでは筆者は確認できていません。何か情報をお持ちの方がいたら遠慮なくコメントください。

# Nuxt 3 で新たに追加された関数の紹介

今回は公式でも目玉として紹介されている「useFetch/useAsyncData」「useState」について紹介します。

## useFetch/useAsyncData でデータの Fetch を行う

公式ドキュメントは[こちら](https://v3.nuxtjs.org/docs/usage/data-fetching)

## useState でグローバルな State 管理を行う

公式ドキュメントは[こちら](https://v3.nuxtjs.org/docs/usage/state)

# おわりに
